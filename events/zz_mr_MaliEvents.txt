namespace = mr_MaliFlavor

country_event = {
	id = mr_MaliFlavor.1
	title = mr_MaliFlavor.1.t
	desc = mr_MaliFlavor.1.d
	picture = muslimgfx_SHIP_SAILING_eventPicture

	is_triggered_only = yes
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					continent = south_america
				}
				save_event_target_as = mr_colonialism_base
			}
		}
	}

	option = {
		name = mr_MaliFlavor.1.a
		add_treasury = -50
		add_adm_power = -100
		trigger = {
			NOT = {
				num_of_owned_provinces_with = {
					value = 3
					OR = {
						continent = south_america
						continent = north_america
					}
				}
			}
		}
		custom_tooltip = two_random_province_colonies
		hidden_effect = {
			event_target:mr_colonialism_base = {
				random_empty_neighbor_province = {
					create_colony_mission_reward_province = {
						country = ROOT
					}
				 }	
			}
			event_target:mr_colonialism_base = {
				random_empty_neighbor_province = {
					create_colony_mission_reward_province = {
						country = ROOT
					}
				 }	
			}
		}
		
	}

	option = {
		name = mr_MaliFlavor.1.b
		event_target:mr_colonialism_base = {
			add_province_modifier = {
				name = expanded_colonial_efforts
				duration = -1
			}
		}
	}
}
country_event = {
	id = mr_MaliFlavor.2
	title = mr_MaliFlavor.2.t
	desc = mr_MaliFlavor.2.d
	picture = SONGHAI_eventPicture

	is_triggered_only = yes

	option = {
		name = mr_MaliFlavor.2.a
		trigger = {
			any_province = {
				trade_goods = sugar
				NOT = {
					country_or_non_sovereign_subject_holds = ROOT
				}
				owner = {
					has_opinion = {
						who = ROOT
						value = 100
					}
					capital_scope = {
						NOT = {
							OR = {
								continent = south_america
								continent = north_america
							}
						}
					}
				}
			}
		}
		random_province = {
			limit = {
				OR = {
					area = dominica_area
					area = hispaniola_area
				}
				NOT = {
					OR = {
						trade_goods = sugar
						trade_goods = rum
					}
				}
				country_or_non_sovereign_subject_holds = ROOT
			}
			change_trade_goods = sugar
		}
		random_province = {
			limit = {
				trade_goods = sugar
				owner = {
					capital_scope = {
						NOT = {
							or = {
								continent = south_america
								continent = north_america
							}
						}
					}
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
			}
			add_province_modifier = {
				name = exporting_sugar
				duration = 3650
			}
		}
		add_treasury = -100
	}

	option = {
		name = mr_MaliFlavor.2.b
		trigger = {
			any_owned_province = {
				NOT = {
					OR = {
						continent = south_america
						continent = north_america
					}
				}
				trade_goods = sugar
			}
		}
		random_province = {
			limit = {
				OR = {
					area = dominica_area
					area = hispaniola_area
				}
				NOT = {
					OR = {
						trade_goods = sugar
						trade_goods = rum
					}
				}
				country_or_non_sovereign_subject_holds = ROOT
			}
			change_trade_goods = sugar
		}
		random_owned_province = {
			limit = {
				NOT = {
					or = {
						continent = south_america
						continent = north_america
					}
				}
				trade_goods = sugar
			}
			add_province_modifier = {
				name = exporting_sugar_1
				duration = 3650
			}
		}
		add_treasury = -50
	}
	option = {
		name = mr_MaliFlavor.2.c
	}
}
country_event = {
	id = mr_MaliFlavor.3
	title = mr_MaliFlavor.3.t
	desc = mr_MaliFlavor.3.d
	picture = SONGHAI_RULER_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = mr_MaliFlavor.3.a
		1096 = {
			cede_province = MAL
			add_core = MAL
			remove_core = ROOT
		}
		MAL = {
			set_country_flag = MAL_happy
			country_event = {
				id = mr_MaliFlavor.4
			}
		}
		ai_chance = {
			factor = 40
			modifier = {
				factor = 1.25
				MAL = {
					diplomatic_reputation = 2
				}
			}
			modifier = {
				factor = 1.5
					owes_favors = { 
						who = MAL 
						value = 15 
			 	 	}
			}
			modifier = {
				factor = 1.5
				has_opinion_modifier = {
					who = MAL
					modifier = sent_gift
					value = 20
				}
			}
		}
	}
	option = {
		name = mr_MaliFlavor.3.b
		MAL = {
			add_trust = {
				who = ROOT
				value = -50
				mutual = yes
			}
			hidden_effect = {
				set_country_flag = MAL_mad
			}
		}
		MAL = {
			country_event = {
				id = mr_MaliFlavor.4
			}
		}
		ai_chance = {
			factor = 60
		}
	}
}

country_event = {
	id = mr_MaliFlavor.4
	title = mr_MaliFlavor.4.t
	desc = mr_MaliFlavor.4.d
	picture = SONGHAI_RULER_eventPicture

	is_triggered_only = yes

	option = {
		trigger = {
			has_country_flag = MAL_happy
		}
		name = mr_MaliFlavor.4.a
		custom_tooltip = gain_ability_to_diplo_vassalize_jolof
	}

	option = {
		trigger = {
			has_country_flag = MAL_mad
		}
		name = mr_MaliFlavor.4.b
		custom_tooltip = gain_ability_to_declare_war_for_farma
		break_alliance = JOL
		add_casus_belli = {
			type = cb_farma_subjugation_war
			target = JOL
		}
	}
}
country_event = {
	id = mr_MaliFlavor.5
	title = mr_MaliFlavor.5.t
	desc = mr_MaliFlavor.5.d
	picture = MALI_RULER_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			clr_country_flag = MAL_happy
		}
		
	}
	
	option = {
		name = mr_MaliFlavor.5.a
		MAL = {
			create_subject = {
				who = ROOT
				subject_type = farma_subject
			}
		}
		farma_dynamic_name_change_effect = yes
		MAL = {
			set_country_flag = mali_subject_jol
			country_event = {
				id = mr_MaliFlavor.6
			}
		}
		ai_chance = {
			factor = 30
			modifier = {
				factor = 1.6
				trust = { 
					who = MAL 
					value = 80 
				}
			}
			modifier = {
				factor = 1.6
					owes_favors = { 
						who = MAL 
						value = 50 
			 	 	}
			}
			modifier = {
				factor = 1.6
				trust = {
					who = MAL 
				 	value = 90 
				}
			}
		}
	}

	option = {
		name = mr_MaliFlavor.5.b
		MAL = {
			country_event = {
				id = mr_MaliFlavor.6
			}
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0
				trust = { who = MAL value = 90 }
				owes_favors = { 
					who = MAL 
					value = 50 
				}
			}
		}
	}
}

country_event = {
	id = mr_MaliFlavor.6
	title = mr_MaliFlavor.6.t
	desc = mr_MaliFlavor.6.d
	picture = ASKIA_eventPicture

	is_triggered_only = yes

	option = {
		name = mr_MaliFlavor.6.a
		trigger = {
			has_country_flag = mali_subject_jol
		}
		add_prestige = 20
	}

	option = {
		trigger = {
			NOT = {
				has_country_flag = mali_subject_jol
			}	
		}
		name = mr_MaliFlavor.6.b
		custom_tooltip = gain_ability_to_declare_war_for_farma
		break_alliance = JOL
		add_casus_belli = {
			type = cb_farma_subjugation_war
			target = JOL
		}
	}
}