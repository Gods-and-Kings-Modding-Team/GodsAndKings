namespace = mr_lollard
#file names are called lollard but its called Wycliffite ingame

#Twelve Conclusions will fire in order upon converting
#The First Conclusion
country_event = {
	id = mr_lollard.1
	title = mr_lollard.1.t
	desc = mr_lollard.1.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		#triggered by converting to Lollardy
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 0
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 1
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.1.a
		if = {
			limit = {
				capital_scope = {
					can_have_center_of_reformation_trigger = {
						RELIGION = mr_lollard
					}
				}
			}
			capital_scope = {
				change_religion = mr_lollard
				add_reform_center = mr_lollard
				add_permanent_province_modifier = {
					name = "religious_zeal_at_conv"
					duration = 9000
				}
			}
		}
		else = {
			random_owned_province = {
				limit = {
					can_have_center_of_reformation_trigger = {
						RELIGION = mr_lollard
					}
				}
				change_religion = mr_lollard
				add_reform_center = mr_lollard
				add_permanent_province_modifier = {
					name = "religious_zeal_at_conv"
					duration = 9000
				}
			}
		}
		add_country_modifier = {
			name = "conversion_zeal"
			duration = 3650
		}
	}
	
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}

#The Second Conclusion
country_event = {
	id = mr_lollard.2
	title = mr_lollard.2.t
	desc = mr_lollard.2.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 1
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 2
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.2.a
		add_estate_influence_modifier = {
			estate = estate_church
			desc = EST_VAL_CHURCH_LOLLARD_RESTRUCTURE
			influence = -25
			duration = 3650
		}
		add_country_modifier = {
			name = mr_lollard_reexamine_1
			duration = 3650
		}
		custom_tooltip = mr_will_unlock_lollard_reform_A
		hidden_effect = { set_country_flag = mr_unlock_lollard_reform_A }
	}
	
	option = {
		name = mr_lollard.2.b
		trigger = {
			tag = ENG
		}
		add_estate_influence_modifier = {
			estate = estate_church
			desc = EST_VAL_CHURCH_LOLLARD_RESTRUCTURE
			influence = -25
			duration = 3650
		}
		add_country_modifier = {
			name = mr_lollard_reexamine_2
			duration = 3650
		}
		custom_tooltip = mr_will_unlock_lollard_reform_B
		hidden_effect = { set_country_flag = mr_unlock_lollard_reform_B }
	}
	
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}

#The Third Conclusion
country_event = {
	id = mr_lollard.3
	title = mr_lollard.3.t
	desc = mr_lollard.3.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 2
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 3
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.3.a
		add_country_modifier = {
			name = mr_lollard_conc_3
			duration = -1
		}
		add_estate_loyalty = {
			estate = estate_church
			loyalty = 10
		}
	}
	option = {
		name = mr_lollard.3.b
		add_country_modifier = {
			name = mr_lollard_conc_3b
			duration = -1
		}
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Fourth Conclusion
country_event = {
	id = mr_lollard.4
	title = mr_lollard.4.t
	desc = mr_lollard.4.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 3
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 4
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.4.a
		add_country_modifier = {
			name = mr_lollard_conc_4
			duration = -1
		}
	}
	option = {
		name = mr_lollard.4.b
		add_country_modifier = {
			name = mr_lollard_conc_4b
			duration = -1
		}
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Fifth Conclusion
country_event = {
	id = mr_lollard.5
	title = mr_lollard.5.t
	desc = mr_lollard.5.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 4
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 5
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.5.a
		add_country_modifier = {
			name = mr_lollard_conc_5
			duration = -1
		}
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Sixth Conclusion
country_event = {
	id = mr_lollard.6
	title = mr_lollard.6.t
	desc = mr_lollard.6.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 5
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 6
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.6.a
		trigger = {
			OR = {
				NOT = { has_reform = mr_lollard_state_head }
				NOT = { has_country_flag = mr_unlock_lollard_reform_A }
			}
		}
		hidden_effect = { set_country_flag = CLERICAL_AUTONOMY_LOLLARD_FLAG }
		tooltip = {
			add_estate_influence_modifier = {
				estate = estate_church
				desc = CLERICAL_AUTONOMY_LOLLARD
				influence = 5
				duration = -1
			}
			add_estate_loyalty_modifier = {
				estate = estate_church
				desc = CLERICAL_AUTONOMY_LOLLARD_LOYALTY
				loyalty = 10
				duration = -1
			}
		}
	}
	
	option = {
		name = mr_lollard.6.b
		add_country_modifier = {
			name = mr_lollard_conc_6
			duration = -1
		}
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Seventh Conclusion
country_event = {
	id = mr_lollard.7
	title = mr_lollard.7.t
	desc = mr_lollard.7.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 6
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 7
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.7.a
		add_country_modifier = {
			name = mr_lollard_conc_7
			duration = -1
		}
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Eighth Conclusion
country_event = {
	id = mr_lollard.8
	title = mr_lollard.8.t
	desc = mr_lollard.8.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 7
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 8
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.8.a
		add_country_modifier = {
			name = mr_lollard_conc_8
			duration = -1
		}
	}
	option = {
		name = mr_lollard.8.b
		add_country_modifier = {
			name = mr_lollard_conc_8b
			duration = -1
		}
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Ninth Conclusion
country_event = {
	id = mr_lollard.9
	title = mr_lollard.9.t
	desc = mr_lollard.9.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 8
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 9
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.9.a
		hidden_effect = { set_country_flag = NO_CONFESSIONS_LOLLARD_FLAG }
		tooltip = {
			add_estate_influence_modifier = {
				estate = estate_church
				desc = NO_CONFESSIONS_LOLLARD
				influence = -10
				duration = -1
			}
		}
		add_prestige = 10
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Tenth Conclusion
country_event = {
	id = mr_lollard.10
	title = mr_lollard.10.t
	desc = mr_lollard.10.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 9
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 10
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.10.a
		add_country_modifier = {
			name = mr_lollard_conc_10
			duration = -1
		}
	}
	option = {
		name = mr_lollard.10.b
		add_country_modifier = {
			name = mr_lollard_conc_10b
			duration = -1
		}
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Eleventh Conclusion
country_event = {
	id = mr_lollard.11
	title = mr_lollard.11.t
	desc = mr_lollard.11.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 10
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 11
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.11.a
		add_country_modifier = {
			name = mr_lollard_conc_11
			duration = -1
		}
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#The Twelfth Conclusion
country_event = {
	id = mr_lollard.12
	title = mr_lollard.12.t
	desc = mr_lollard.12.d
	picture = POPE_PREACHING_eventPicture
	
	is_triggered_only = yes
	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 11
		}
		NOT = {
			check_variable = {
				which = lollardConclusionProgress
				value = 12
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = mr_lollard.12.a
		custom_tooltip = conclusion_twelve_TT
		hidden_effect = { set_country_flag = conclusion_twelve_crafts }
	}
	option = {
		name = mr_lollard.12.b
		add_prestige = 10
		hidden_effect = { set_country_flag = conclusion_twelve_stricken }
	}
	after = {
		change_variable = {
			which = lollardConclusionProgress
			value = 1
		}
	}
}
#Original Wycliffe Bible Rediscovered
country_event = {
	id = mr_lollard.13
	title = mr_lollard.13.t
	desc = mr_lollard.13.d
	picture = POPE_PREACHING_eventPicture

	trigger = {
		religion = mr_lollard
		check_variable = {
			which = lollardConclusionProgress
			value = 12
		}
	}
	mean_time_to_happen = { 
		years = 40
	}
	
	immediate = {
		if = {
			limit = { #struck 3 conlusions from the record
				has_country_modifier = mr_lollard_conc_6
				has_country_modifier = mr_lollard_conc_10
				has_country_flag = conclusion_twelve_stricken
			}
			random_owned_province = {
				limit = { religion = mr_lollard }
				save_event_target_as = lollard_purists_revolt_1
			}
			random_owned_province = {
				limit = { religion = mr_lollard }
				save_event_target_as = lollard_purists_revolt_2
			}
			random_owned_province = {
				limit = { religion = mr_lollard }
				save_event_target_as = lollard_purists_revolt_3
			}
		}
		else_if = { #struck only 2 from the record
			limit = {
				OR = {
					AND = {
						has_country_modifier = mr_lollard_conc_6
						has_country_modifier = mr_lollard_conc_10
					}
					AND = {
						has_country_modifier = mr_lollard_conc_6
						has_country_flag = conclusion_twelve_stricken
					}
					AND = {
						has_country_modifier = mr_lollard_conc_10
						has_country_flag = conclusion_twelve_stricken
					}
				}
			}
			random_owned_province = {
				limit = { religion = mr_lollard }
				save_event_target_as = lollard_purists_revolt_1
			}
			random_owned_province = {
				limit = { religion = mr_lollard }
				save_event_target_as = lollard_purists_revolt_2
			}
		}
		else = { # only 1 stricken from record
			random_owned_province = {
				limit = { religion = mr_lollard }
				save_event_target_as = lollard_purists_revolt_1
			}
		}
	}
	
	option = {
		name = mr_lollard.13.a
		event_target:lollard_purists_revolt_1 = {
			spawn_rebels = {
				type = lollard_rebels
				size = 2
			}
		}
		event_target:lollard_purists_revolt_2 = {
			spawn_rebels = {
				type = lollard_rebels
				size = 2
			}
		}
		event_target:lollard_purists_revolt_3 = {
			spawn_rebels = {
				type = lollard_rebels
				size = 2
			}
		}
		add_country_modifier = {
			name = mr_lollard_revealed
			duration = 9125
		}
	}
}

#Wycliffites Debate on the Reformation
country_event = {
	id = mr_lollard.14
	title = mr_lollard.14.t
	desc = mr_lollard.14.d
	picture = POPE_PREACHING_eventPicture
	
	trigger = {
		is_religion_enabled = protestant
		religion = mr_lollard
	}
	mean_time_to_happen = { 
		years = 10
		modifier = {
			factor = 0.5
			any_neighbor_country = {
				religion = protestant
			}
		}
	}
	
	option = {
		name = mr_lollard.14.a
		custom_tooltip = mr_eng_prods_are_more_likely
		hidden_effect = { set_country_flag = me_eng_wycliffe_convert }
	}
	option = {
		name = mr_lollard.14.b
		add_country_modifier = {
			name = mr_eng_wycliffe_isolation
			duration = 18250
		}
	}
}